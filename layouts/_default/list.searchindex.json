{{- $.Scratch.Add "searchindex" slice -}}
{{- range $index, $element := (where .Site.Pages "Kind" "page").Reverse -}}
	{{ $type := "page" }}
	{{ $url := .RelPermalink }}
	{{ if eq $element.Type "posts" }}
		{{ $type = "blog post"}}
	{{ end }}
	{{ if $element.Params.external_url }}
		{{ $type = "external blog post"}}
		{{ $url = $element.Params.external_url }}
	{{ end }}
	{{ $date := "" }}
	{{ if not $element.Date.IsZero }}
		{{ $date = dateFormat "Jan 2 2006" $element.Date }}
	{{ end }}
	{{- $.Scratch.Add "searchindex" (dict "id" $index "title" $element.Title "url" $url "type" $type "date" $date "body" $element.RawContent) -}}
{{- end -}}
{{- $.Scratch.Get "searchindex" | jsonify -}}
